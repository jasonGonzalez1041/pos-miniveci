(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[132],{6437:(e,s,a)=>{Promise.resolve().then(a.bind(a,8223))},8223:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var r=a(5155),i=a(2115),c=a(1),t=a(5460),l=a(5193),n=a(3312),d=a(3900),o=a(8986),h=a(9749),m=a(2508),x=a(5121),p=a(1773),j=a(5996),u=a(1836),g=a(7401);let N=(0,g.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),v=(0,g.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),y=(0,g.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),k=(0,g.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function f(){let[e,s]=(0,i.useState)([]),[a,g]=(0,i.useState)(null),[f,w]=(0,i.useState)({name:"",description:"",price:"",stock:"",imageUrl:""}),[A,b]=(0,i.useState)(!0),{isOnline:E,isSyncing:C,isInitialized:S,triggerSync:P}=(0,t.s)(),F=async()=>{try{let e=await c.E.getAllProducts();s(e)}catch(e){console.error("Failed to load products:",e)}finally{b(!1)}};(0,i.useEffect)(()=>{S&&F()},[S]);let U=async e=>{e.preventDefault();try{let e={name:f.name,description:f.description||null,price:Math.round(100*parseFloat(f.price)),stock:parseInt(f.stock)||0,imageUrl:f.imageUrl||null};a?await c.E.updateProduct(a,e):await c.E.insertProduct(e),await F(),g(null),w({name:"",description:"",price:"",stock:"",imageUrl:""}),E&&(0,l.Qr)(1e3)}catch(e){console.error("Failed to save product:",e),alert("Error guardando producto. Ver consola.")}},M=e=>{g(e.id),w({name:e.name,description:e.description||"",price:(e.price/100).toFixed(2),stock:e.stock.toString(),imageUrl:e.imageUrl||""})},z=async e=>{if(confirm("Seguro que quieres eliminar este producto?"))try{await c.E.deleteProduct(e),await F(),E&&(0,l.Qr)(1e3)}catch(e){console.error("Failed to delete product:",e),alert("Error eliminando producto. Ver consola.")}};return S?(0,r.jsxs)("div",{className:"container mx-auto p-6 max-w-6xl space-y-6",children:[(0,r.jsx)(h.Zp,{children:(0,r.jsx)(h.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h.ZB,{className:"text-3xl",children:"Mantenimiento de Productos"}),(0,r.jsx)(h.BT,{children:"Local-first POS con sync autom\xe1tico"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(x.E,{variant:E?"default":"secondary",className:"flex items-center gap-2",children:[E?(0,r.jsx)(j.A,{className:"h-4 w-4"}):(0,r.jsx)(u.A,{className:"h-4 w-4"}),E?"Online":"Offline"]}),C&&(0,r.jsxs)(x.E,{variant:"outline",className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"h-3 w-3 animate-spin"}),"Syncing..."]}),E&&(0,r.jsx)(n.$,{variant:"outline",size:"sm",onClick:P,disabled:C,children:(0,r.jsx)(p.A,{className:"h-4 w-4 ".concat(C?"animate-spin":"")})})]})]})})}),(0,r.jsxs)(h.Zp,{children:[(0,r.jsx)(h.aR,{children:(0,r.jsxs)(h.ZB,{className:"flex items-center gap-2",children:[a?(0,r.jsx)(N,{className:"h-5 w-5"}):(0,r.jsx)(v,{className:"h-5 w-5"}),a?"Editar Producto":"Agregar Producto"]})}),(0,r.jsx)(h.Wu,{children:(0,r.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.J,{htmlFor:"name",children:"Nombre *"}),(0,r.jsx)(d.p,{id:"name",value:f.name,onChange:e=>w({...f,name:e.target.value}),required:!0,placeholder:"Ej: Coca Cola 2L"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.J,{htmlFor:"price",children:"Precio ($) *"}),(0,r.jsx)(d.p,{id:"price",type:"number",step:"0.01",value:f.price,onChange:e=>w({...f,price:e.target.value}),required:!0,placeholder:"10.50"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.J,{htmlFor:"description",children:"Descripci\xf3n"}),(0,r.jsx)(d.p,{id:"description",value:f.description,onChange:e=>w({...f,description:e.target.value}),placeholder:"Descripci\xf3n del producto"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.J,{htmlFor:"stock",children:"Stock *"}),(0,r.jsx)(d.p,{id:"stock",type:"number",value:f.stock,onChange:e=>w({...f,stock:e.target.value}),required:!0,placeholder:"100"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o.J,{htmlFor:"imageUrl",children:"URL Imagen"}),(0,r.jsx)(d.p,{id:"imageUrl",value:f.imageUrl,onChange:e=>w({...f,imageUrl:e.target.value}),placeholder:"https://..."})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.$,{type:"submit",children:"Guardar"}),a&&(0,r.jsxs)(n.$,{type:"button",variant:"outline",onClick:()=>{g(null),w({name:"",description:"",price:"",stock:"",imageUrl:""})},children:[(0,r.jsx)(y,{className:"h-4 w-4 mr-2"}),"Cancelar"]})]})]})})]}),(0,r.jsxs)(h.Zp,{children:[(0,r.jsx)(h.aR,{children:(0,r.jsxs)(h.ZB,{children:["Productos (",e.length,")"]})}),(0,r.jsx)(h.Wu,{children:A?(0,r.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin"})}):0===e.length?(0,r.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,r.jsx)("p",{children:"No hay productos registrados"}),(0,r.jsx)("p",{className:"text-sm mt-2",children:"Agrega tu primer producto para comenzar"})]}):(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(m.XI,{children:[(0,r.jsx)(m.A0,{children:(0,r.jsxs)(m.Hj,{children:[(0,r.jsx)(m.nd,{children:"Nombre"}),(0,r.jsx)(m.nd,{children:"Descripci\xf3n"}),(0,r.jsx)(m.nd,{className:"text-right",children:"Precio"}),(0,r.jsx)(m.nd,{className:"text-right",children:"Stock"}),(0,r.jsx)(m.nd,{className:"text-center",children:"Estado"}),(0,r.jsx)(m.nd,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(m.BF,{children:e.map(e=>(0,r.jsxs)(m.Hj,{children:[(0,r.jsx)(m.nA,{className:"font-medium",children:e.name}),(0,r.jsx)(m.nA,{className:"text-muted-foreground",children:e.description||"-"}),(0,r.jsxs)(m.nA,{className:"text-right",children:["$",(e.price/100).toFixed(2)]}),(0,r.jsx)(m.nA,{className:"text-right",children:0===e.stock?(0,r.jsx)("span",{className:"text-red-600 font-medium",children:"Sin stock"}):"Stock: ".concat(e.stock)}),(0,r.jsx)(m.nA,{className:"text-center",children:0===e.synced?(0,r.jsx)(x.E,{variant:"outline",children:"Pendiente sincronizaci\xf3n"}):(0,r.jsx)(x.E,{variant:"secondary",children:"Sincronizado"})}),(0,r.jsx)(m.nA,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(n.$,{"aria-label":"Editar",variant:"ghost",size:"sm",onClick:()=>M(e),children:(0,r.jsx)(N,{className:"h-4 w-4"})}),(0,r.jsx)(n.$,{"aria-label":"Eliminar",variant:"ghost",size:"sm",onClick:()=>z(e.id),children:(0,r.jsx)(k,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]})]}):(0,r.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,r.jsx)(h.Zp,{children:(0,r.jsx)(h.Wu,{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(p.A,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Inicializando base de datos local..."})]})})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[644,521,441,517,358],()=>s(6437)),_N_E=e.O()}]);