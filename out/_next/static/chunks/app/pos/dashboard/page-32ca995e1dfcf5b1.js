(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{3326:(e,s,a)=>{Promise.resolve().then(a.bind(a,3547))},3547:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>v});var i=a(5155),r=a(2115),c=a(1),n=a(5460),l=a(5193),t=a(3312),d=a(3900),o=a(8986),m=a(9749),x=a(2508),h=a(5121),u=a(1773),j=a(5996),p=a(1836),g=a(814);function v(){let[e,s]=(0,r.useState)([]),[a,v]=(0,r.useState)(null),[N,f]=(0,r.useState)({name:"",description:"",price:"",stock:"",imageUrl:""}),[y,k]=(0,r.useState)(!0),{isOnline:A,isSyncing:w,isInitialized:E,triggerSync:b}=(0,n.s)(),F=async()=>{try{let e=await c.E.getAllProducts();s(e)}catch(e){console.error("Failed to load products:",e),g.oR.error("Error carga local.")}finally{k(!1)}};(0,r.useEffect)(()=>{E&&F()},[E]);let C=async e=>{e.preventDefault();try{let e={name:N.name,description:N.description||null,price:Math.round(100*parseFloat(N.price)),stock:parseInt(N.stock)||0,imageUrl:N.imageUrl||null};a?await c.E.updateProduct(a,e):await c.E.insertProduct(e),await F(),v(null),f({name:"",description:"",price:"",stock:"",imageUrl:""}),g.oR.success(A?"Guardado en cloud.":"Guardado local (sync pronto)."),A&&(0,l.Qr)(1e3)}catch(e){console.error("Failed to save product:",e),g.oR.error("Error al guardar.")}},P=async e=>{try{await c.E.deleteProduct(e),await F(),g.oR.success("Eliminado."),A&&(0,l.Qr)(1e3)}catch(e){console.error("Failed to delete product:",e),g.oR.error("Error al eliminar.")}},U=s=>{let a=e.find(e=>e.id===s);a&&(v(s),f({name:a.name,description:a.description||"",price:(a.price/100).toFixed(2),stock:a.stock.toString(),imageUrl:a.imageUrl||""}))};return E?(0,i.jsxs)("div",{className:"container mx-auto p-6 max-w-6xl",children:[(0,i.jsx)(m.Zp,{children:(0,i.jsx)(m.aR,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)(m.ZB,{className:"text-3xl",children:"Mantenimiento POS - Miniveci"}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsxs)(h.E,{variant:A?"default":"secondary",className:"flex items-center gap-2",children:[A?(0,i.jsx)(j.A,{className:"h-4 w-4"}):(0,i.jsx)(p.A,{className:"h-4 w-4"}),A?"Online":"Offline"]}),w&&(0,i.jsxs)(h.E,{variant:"outline",className:"flex items-center gap-2",children:[(0,i.jsx)(u.A,{className:"h-3 w-3 animate-spin"}),"Syncing..."]}),A&&(0,i.jsx)(t.$,{variant:"outline",size:"sm",onClick:b,disabled:w,children:(0,i.jsx)(u.A,{className:"h-4 w-4 ".concat(w?"animate-spin":"")})})]})]})})}),(0,i.jsxs)(m.Zp,{className:"mt-6",children:[(0,i.jsx)(m.aR,{children:(0,i.jsx)(m.ZB,{children:a?"Editar Producto":"Agregar Producto"})}),(0,i.jsx)(m.Wu,{children:(0,i.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"name",children:"Nombre"}),(0,i.jsx)(d.p,{id:"name",value:N.name,onChange:e=>f({...N,name:e.target.value}),required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"price",children:"Precio ($)"}),(0,i.jsx)(d.p,{id:"price",type:"number",step:"0.01",value:N.price,onChange:e=>f({...N,price:e.target.value}),required:!0})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"description",children:"Descripci\xf3n"}),(0,i.jsx)(d.p,{id:"description",value:N.description,onChange:e=>f({...N,description:e.target.value})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"stock",children:"Stock"}),(0,i.jsx)(d.p,{id:"stock",type:"number",value:N.stock,onChange:e=>f({...N,stock:e.target.value}),required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"imageUrl",children:"ID Imagen"}),(0,i.jsx)(d.p,{id:"imageUrl",value:N.imageUrl,onChange:e=>f({...N,imageUrl:e.target.value})})]})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(t.$,{type:"submit",children:a?"Actualizar":"Agregar"}),a&&(0,i.jsx)(t.$,{type:"button",variant:"outline",onClick:()=>{v(null),f({name:"",description:"",price:"",stock:"",imageUrl:""})},children:"Cancelar"})]})]})})]}),(0,i.jsxs)(m.Zp,{className:"mt-6",children:[(0,i.jsx)(m.aR,{children:(0,i.jsx)(m.ZB,{children:"Productos"})}),(0,i.jsx)(m.Wu,{children:y?(0,i.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,i.jsx)(u.A,{className:"h-6 w-6 animate-spin"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(x.XI,{children:[(0,i.jsx)(x.A0,{children:(0,i.jsxs)(x.Hj,{children:[(0,i.jsx)(x.nd,{children:"Nombre"}),(0,i.jsx)(x.nd,{children:"Descripci\xf3n"}),(0,i.jsx)(x.nd,{children:"Precio"}),(0,i.jsx)(x.nd,{children:"Stock"}),(0,i.jsx)(x.nd,{children:"Acciones"})]})}),(0,i.jsx)(x.BF,{children:e.map(e=>(0,i.jsxs)(x.Hj,{children:[(0,i.jsx)(x.nA,{className:"font-medium",children:e.name}),(0,i.jsx)(x.nA,{children:e.description||"-"}),(0,i.jsxs)(x.nA,{children:["$",(e.price/100).toFixed(2)]}),(0,i.jsx)(x.nA,{children:e.stock}),(0,i.jsxs)(x.nA,{className:"space-x-2",children:[(0,i.jsx)(t.$,{variant:"outline",size:"sm",onClick:()=>U(e.id),children:"Editar"}),(0,i.jsx)(t.$,{variant:"destructive",size:"sm",onClick:()=>P(e.id),children:"Eliminar"})]})]},e.id))})]}),0===e.length&&(0,i.jsx)("p",{className:"text-center text-muted-foreground mt-4",children:"No hay productos. \xa1Agrega uno!"})]})})]})]}):(0,i.jsx)("div",{className:"container mx-auto p-6 max-w-6xl",children:(0,i.jsx)(m.Zp,{children:(0,i.jsx)(m.Wu,{className:"flex items-center justify-center h-64",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)(u.A,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Inicializando base de datos local..."})]})})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[644,814,521,441,517,358],()=>s(3326)),_N_E=e.O()}]);